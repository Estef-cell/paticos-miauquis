
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Producto - Paticos Miauquis</title>
  <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>

  <header class="main-header">
    <a href="./index.html" class="logo">
      <img src="../assets/img/logo.png" alt="Logo Paticos Miauquis">
      <span>Paticos Miauquis</span>
    </a>
    <nav class="main-nav">
      <ul>
        <li><a href="./index.html">Inicio</a></li>
        <li><a href="./productos.html">Productos</a></li>
        <li><a href="./nosotros.html">Nosotros</a></li>
        <li><a href="./blogs.html">Blog</a></li>
        <li><a href="./contacto.html">Contacto</a></li>
        <li><a href="./inicio-sesion.html">Login</a></li>
        <li><a href="./carrito.html" class="cart-icon">
          🛒 <span id="cart-count" class="badge">0</span>
        </a></li>
      </ul>
    </nav>
  </header>

  <main class="container" id="product-container">
    <!-- El detalle del producto se cargará aquí -->
  </main>

  <footer class="main-footer">
    <div class="footer-content">
      <p>&copy; 2025 Paticos Miauquis. Todos los derechos reservados.</p>
      <div class="footer-links">
        <a href="./nosotros.html">Sobre Nosotros</a>
        <a href="./contacto.html">Contacto</a>
        <a href="./inicio-sesion.html">Iniciar Sesión</a>
      </div>
    </div>
  </footer>

  <script src="../assets/js/cart.js" type="module"></script>
  <script type="module">
    import { PRODUCTS } from '../assets/js/products.js';
    import { addToCart } from '../assets/js/cart.js';

    const productContainer = document.getElementById('product-container');

    const renderProduct = () => {
      const params = new URLSearchParams(window.location.search);
      const productId = params.get('id');
      const product = PRODUCTS.find(p => p.id === productId);

      if (product) {
        document.title = `${product.name} - Paticos Miauquis`;
        productContainer.innerHTML = `
          <article class="product-detail">
            <img src="${product.img}" alt="${product.name}">
            <div>
              <h1>${product.name}</h1>
              <p>${product.desc}</p>
              <p class="product-detail-price">$${product.price.toLocaleString('es-CL')}</p>
              <p class="product-detail-stock">Stock disponible: ${product.stock}</p>
              <div class="product-detail-actions">
                <input type="number" id="quantity" value="1" min="1" max="${product.stock}" aria-label="Cantidad">
                <button id="add-to-cart-btn" class="btn btn-accent">Añadir al carrito</button>
              </div>
            </div>
          </article>
        `;

        document.getElementById('add-to-cart-btn').addEventListener('click', () => {
          const quantityInput = document.getElementById('quantity');
          const quantity = parseInt(quantityInput.value, 10);
          addToCart(product.id, quantity);
          Swal.fire({
            title: '¡Añadido!',
            text: `${quantity} x ${product.name} añadido(s) al carrito.`,
            icon: 'success',
            timer: 2000,
            showConfirmButton: false
          });
        });

      } else {
        document.title = 'Producto no encontrado';
        productContainer.innerHTML = '<h1>404 - Producto no encontrado</h1><p>El producto que buscas no existe. <a href="./productos.html">Volver a productos</a>.</p>';
      }
    };

    renderProduct();
  </script>

</body>
</html>
